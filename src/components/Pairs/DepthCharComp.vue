<template>
  <div class="cont-box">
    <div class="cont-title">深度图</div>
    <div class="block-height">
      <div id="chart-root"></div>
    </div>
  </div>
</template>

<script>
export default {
  name: "depth-char-comp",
  props: [
    'baseCoin',
    'targetCoin'
  ],
  data () {
    return {
      chart: null,
      depthData: {
        "askBills": [
          [
            7489.87,
            0.201287
          ],
          [
            7491.23,
            0.210746
          ],
          [
            7492.11,
            0.214553
          ],
          [
            7492.45,
            0.248943
          ],
          [
            7492.92,
            0.285007
          ],
          [
            7493.57,
            0.310045
          ],
          [
            7495.05,
            0.337475
          ],
          [
            7496.09,
            0.381784
          ],
          [
            7496.65,
            0.42901100000000003
          ],
          [
            7497.79,
            0.435082
          ],
          [
            7497.98,
            0.482708
          ],
          [
            7498.82,
            0.48745000000000005
          ],
          [
            7499.01,
            0.5166240000000001
          ],
          [
            7499.04,
            0.556718
          ],
          [
            7499.42,
            0.6003550000000001
          ],
          [
            7500.33,
            0.6124010000000001
          ],
          [
            7500.43,
            0.6593650000000001
          ],
          [
            7500.95,
            0.6694320000000001
          ],
          [
            7501.01,
            0.6808980000000001
          ],
          [
            7501.59,
            0.7043500000000001
          ],
          [
            7501.81,
            0.7446600000000001
          ],
          [
            7502.66,
            0.7490030000000001
          ],
          [
            7502.68,
            0.779908
          ],
          [
            7503.46,
            0.7920400000000001
          ],
          [
            7503.88,
            0.8209110000000001
          ],
          [
            7507.84,
            0.8606050000000001
          ],
          [
            7508.53,
            0.9064530000000001
          ],
          [
            7508.66,
            0.9514560000000001
          ],
          [
            7509.14,
            1.1850740000000002
          ],
          [
            7510.16,
            1.2295140000000002
          ],
          [
            7513.19,
            1.4566020000000002
          ],
          [
            7514.32,
            2.0590550000000003
          ],
          [
            7515.83,
            2.1063250000000004
          ],
          [
            7521.41,
            2.1430400000000005
          ],
          [
            7522.57,
            2.1722280000000005
          ],
          [
            7522.62,
            2.2219340000000005
          ],
          [
            7522.67,
            2.2424360000000005
          ],
          [
            7524.89,
            2.2560750000000005
          ],
          [
            7526.85,
            2.2910860000000004
          ],
          [
            7527.13,
            2.3365230000000006
          ],
          [
            7528.86,
            2.352661000000001
          ],
          [
            7530.17,
            2.386364000000001
          ],
          [
            7533.45,
            2.4262670000000006
          ],
          [
            7538.18,
            2.476260000000001
          ],
          [
            7538.45,
            2.4876870000000006
          ],
          [
            7539.26,
            2.4939770000000006
          ],
          [
            7542,
            2.5436580000000006
          ],
          [
            7542.27,
            2.5550710000000008
          ],
          [
            7542.65,
            2.5812430000000006
          ],
          [
            7543.63,
            2.5862690000000006
          ],
          [
            7545.13,
            2.6171480000000007
          ],
          [
            7548.46,
            2.6483870000000005
          ],
          [
            7549.04,
            2.6886020000000004
          ],
          [
            7554.32,
            2.6953860000000005
          ],
          [
            7555.07,
            2.7000780000000004
          ],
          [
            7560.3,
            2.7172520000000002
          ],
          [
            7561.23,
            2.7312360000000004
          ],
          [
            7562.8,
            2.7535990000000004
          ],
          [
            7570.22,
            2.765423
          ],
          [
            7574.23,
            2.801
          ],
          [
            7575.42,
            2.80344
          ],
          [
            7577.1,
            2.8073
          ],
          [
            7578.89,
            2.821717
          ],
          [
            7579.68,
            2.879188
          ],
          [
            7580.33,
            2.930181
          ],
          [
            7580.43,
            3.028903
          ],
          [
            7580.99,
            3.111505
          ],
          [
            7581.46,
            3.194652
          ],
          [
            7583.58,
            3.2567310000000003
          ],
          [
            7583.96,
            3.3409590000000002
          ],
          [
            7584.92,
            3.4007750000000003
          ],
          [
            7584.94,
            3.4703470000000003
          ],
          [
            7585.22,
            3.5210800000000004
          ],
          [
            7585.34,
            3.6118330000000003
          ],
          [
            7585.42,
            3.6737240000000004
          ],
          [
            7587.47,
            3.7363250000000003
          ],
          [
            7600,
            4.004325000000001
          ],
          [
            7622.16,
            4.006343
          ],
          [
            7626.74,
            4.010111
          ],
          [
            7633.84,
            4.012468
          ],
          [
            7635,
            4.014468
          ],
          [
            7653.35,
            4.022482
          ],
          [
            7659.55,
            4.0269390000000005
          ],
          [
            7675.85,
            4.034213
          ],
          [
            7678.92,
            4.038603
          ],
          [
            7682.62,
            4.039759
          ],
          [
            7697.29,
            4.046379
          ],
          [
            7797.51,
            4.048255
          ],
          [
            7809.41,
            4.058141
          ],
          [
            7821.66,
            4.065591
          ],
          [
            7867.99,
            4.074053
          ],
          [
            7880.33,
            4.076873
          ],
          [
            7954.06,
            4.082232
          ],
          [
            7955.65,
            4.090126000000001
          ],
          [
            7976.07,
            4.096693000000001
          ],
          [
            7980.66,
            4.105552000000001
          ],
          [
            7993.13,
            4.1080580000000015
          ],
          [
            8000,
            4.3180960000000015
          ],
          [
            8044.16,
            4.322623000000002
          ],
          [
            8075.79,
            4.325787000000002
          ]
        ],
        "buyBills": [
          [
            7487.31,
            0.090188
          ],
          [
            7487.18,
            0.155248
          ],
          [
            7486.77,
            0.274169
          ],
          [
            7481.64,
            0.420657
          ],
          [
            7477.4,
            0.456997
          ],
          [
            7475.83,
            0.473103
          ],
          [
            7475.49,
            0.503013
          ],
          [
            7472.8,
            0.5134160000000001
          ],
          [
            7471.85,
            0.5708470000000001
          ],
          [
            7470.27,
            0.5868690000000001
          ],
          [
            7466.79,
            0.6164810000000001
          ],
          [
            7466.39,
            0.624276
          ],
          [
            7465.61,
            0.660892
          ],
          [
            7465.08,
            0.710843
          ],
          [
            7461.73,
            0.744913
          ],
          [
            7461.18,
            0.747372
          ],
          [
            7460.54,
            0.7567090000000001
          ],
          [
            7460.5,
            0.7668070000000001
          ],
          [
            7457.7,
            0.8118390000000001
          ],
          [
            7457.59,
            0.841605
          ],
          [
            7456.69,
            0.8470040000000001
          ],
          [
            7456.5,
            0.8563640000000001
          ],
          [
            7453.96,
            0.8930930000000001
          ],
          [
            7453.41,
            0.8967290000000001
          ],
          [
            7452.76,
            0.9443600000000001
          ],
          [
            7451.25,
            0.9883500000000001
          ],
          [
            7451.12,
            0.992681
          ],
          [
            7447.19,
            0.9998940000000001
          ],
          [
            7446.49,
            1.024798
          ],
          [
            7445.24,
            1.055457
          ],
          [
            7445.22,
            1.059457
          ],
          [
            7428.79,
            1.0705060000000002
          ],
          [
            7395.09,
            1.0765860000000003
          ],
          [
            7395.02,
            1.0778300000000003
          ],
          [
            7394.75,
            1.0875050000000004
          ],
          [
            7394.21,
            1.0954260000000005
          ],
          [
            7391.57,
            1.0998850000000004
          ],
          [
            7389.41,
            1.1021900000000004
          ],
          [
            7386.12,
            1.1074120000000005
          ],
          [
            7384.67,
            1.1087950000000004
          ],
          [
            7382.51,
            1.1117510000000004
          ],
          [
            7380.97,
            1.1167290000000003
          ],
          [
            7373.46,
            1.1243550000000002
          ],
          [
            7371.82,
            1.1278470000000003
          ],
          [
            7370.97,
            1.1308180000000003
          ],
          [
            7368.61,
            1.1319480000000004
          ],
          [
            7368.5,
            1.1374960000000005
          ],
          [
            7368.34,
            1.1445280000000004
          ],
          [
            7367.71,
            1.1484550000000004
          ],
          [
            7366.08,
            1.1498140000000006
          ],
          [
            7364.18,
            1.1522370000000006
          ],
          [
            7363.76,
            1.1589770000000006
          ],
          [
            7358.6,
            1.1637230000000005
          ],
          [
            7356.47,
            1.1671150000000006
          ],
          [
            7355.58,
            1.1705460000000005
          ],
          [
            7354.58,
            1.1766090000000005
          ],
          [
            7354.33,
            1.1835870000000004
          ],
          [
            7352.37,
            1.1847360000000005
          ],
          [
            7351.14,
            1.1936840000000004
          ],
          [
            7350.76,
            1.2004780000000004
          ],
          [
            7350.22,
            1.2096000000000005
          ],
          [
            7350,
            1.2396000000000005
          ],
          [
            7346.27,
            1.2484590000000004
          ],
          [
            7344.97,
            1.2558750000000005
          ],
          [
            7344.79,
            1.2584930000000005
          ],
          [
            7340.06,
            1.2600000000000005
          ],
          [
            7339.87,
            1.2666030000000004
          ],
          [
            7334.83,
            1.2680260000000003
          ],
          [
            7333.63,
            1.2720720000000003
          ],
          [
            7332.08,
            1.2765990000000003
          ],
          [
            7331.55,
            1.2855120000000002
          ],
          [
            7330.77,
            1.2891610000000002
          ],
          [
            7325.33,
            1.2961400000000003
          ],
          [
            7324.41,
            1.3037700000000003
          ],
          [
            7324.15,
            1.3084900000000004
          ],
          [
            7324.08,
            1.3131640000000004
          ],
          [
            7323.42,
            1.3193320000000004
          ],
          [
            7319.43,
            1.3247620000000004
          ],
          [
            7318.89,
            1.3318080000000005
          ],
          [
            7317.63,
            1.3352940000000006
          ],
          [
            7317.09,
            1.3396830000000006
          ],
          [
            7312.61,
            1.3487210000000007
          ],
          [
            7310.7,
            1.3568660000000008
          ],
          [
            7307.24,
            1.3586210000000007
          ],
          [
            7306.55,
            1.3678080000000008
          ],
          [
            7306.02,
            1.375124000000001
          ],
          [
            7305.75,
            1.3850490000000009
          ],
          [
            7302.28,
            1.3906150000000008
          ],
          [
            7302.22,
            1.3999940000000008
          ],
          [
            7302.15,
            1.404781000000001
          ],
          [
            7300.79,
            1.409626000000001
          ],
          [
            7282.28,
            1.474145000000001
          ],
          [
            7282.26,
            1.4875580000000008
          ],
          [
            7282.22,
            1.5595350000000008
          ],
          [
            7282.16,
            1.6191790000000008
          ],
          [
            7282,
            1.6461890000000008
          ],
          [
            7281.79,
            1.8030910000000009
          ],
          [
            7281.78,
            2.265815000000001
          ],
          [
            7281.16,
            2.295913000000001
          ],
          [
            7281.15,
            2.384004000000001
          ]
        ]
      }
    }
  },
  computed: {},
  watch: {},
  methods: {
    chartInit () {
      // 基于准备好的dom，初始化echarts实例
      let chart = this.chart = window.echarts.init(document.getElementById('chart-root'));

      // 指定图表的配置项和数据
      let option = {
        grid: {
          top: 40,
          bottom: 55,
          left: 50,
          right: 50
        },
        tooltip: {
          show: true,
          trigger: 'axis',
          backgroundColor: '#262a42',
          padding: [10, 15],
          axisPointer: {
            type: 'line',
            lineStyle: {
              type: 'dashed',
              color: '#61688a'
            }
          },
          formatter: params => {
            let val = params[0].value
            let color = params[0].seriesName === 'buy' ? 'color-buy' : 'color-sell'
            return `委托价<span class="${color} ml-15">${val[0].toFixed(4)}</span> ${this.baseCoin}<br/>
                    累积量<span class="${color} ml-15">${val[1].toFixed(4)}</span> ${this.targetCoin}</span>`
          },
          textStyle: {
            color: '#61688a'
          }
        },
        textStyle: {
          color: '#61688a'
        },
        xAxis: {
          name: `委单价格（${this.baseCoin}）`,
          nameTextStyle: {
            padding: [15, 0, 0]
          },
          nameLocation: 'center',
          type: 'category',
          axisLabel: {
            rotate: 15
          }
        },
        yAxis: {
          name: `累积量（${this.targetCoin}）`,
          type: 'value',
          position: 'right',
          splitNumber: 0,
          splitLine: {
            show: false
          }
        },
        series: [
          {
            name: 'buy',
            type: 'line',
            showSymbol: false,
            emphasis: {
              itemStyle: {
                color: '#589065',
                // borderWidth: 0,
                borderColor: '#fff'
              }
            },
            lineStyle: {
              width: 1,
              color: '#589065'
            },
            areaStyle: {
              color: {
                type: 'linear',
                x: 0,
                y: 0,
                x2: 0,
                y2: 1,
                colorStops: [{
                  offset: 0, color: '#589065' // 0% 处的颜色
                }, {
                  offset: 1, color: '#181b2a' // 100% 处的颜色
                }]
              }
            },
            data: this.depthData.buyBills.reverse()
          },
          // {
          //   type: 'line',
          //   data: [
          //     [0, 0],
          //     [0, 1]
          //   ],
          //   tooltip: {
          //     show: false
          //   }
          // },
          {
            name: 'sell',
            type: 'line',
            showSymbol: false,
            emphasis: {
              itemStyle: {
                color: '#ae4e54',
                // borderWidth: 0,
                borderColor: '#fff'
              }
            },
            lineStyle: {
              width: 1,
              color: '#ae4e54'
            },
            areaStyle: {
              color: {
                type: 'linear',
                x: 0,
                y: 0,
                x2: 0,
                y2: 1,
                colorStops: [{
                  offset: 0, color: '#ae4e54' // 0% 处的颜色
                }, {
                  offset: 1, color: '#181b2a' // 100% 处的颜色
                }]
              }
            },
            data: this.depthData.askBills
          }
        ]
      };

      // 使用刚指定的配置项和数据显示图表。
      chart.setOption(option);
    }
  },
  mounted () {
    this.chartInit()
    let resizeTimer = null
    window.addEventListener('resize', () => {
      if (resizeTimer) {
        clearTimeout(resizeTimer)
      }
      resizeTimer = setTimeout(this.chart.resize, 500)
    })
  }
}
</script>

<style scoped>
  #chart-root{
    height: 100%;
    overflow: hidden;
  }
</style>
