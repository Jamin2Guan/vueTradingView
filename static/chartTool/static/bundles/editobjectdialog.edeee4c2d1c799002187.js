webpackJsonp([45,8,56],{1007:function(e,t,o){"use strict";var r,n,a,i,s;Object.defineProperty(t,"__esModule",{value:!0}),r=o(1224),Object.defineProperty(t,"AutocompleteField",{enumerable:!0,get:function(){return r.AutocompleteField}}),n=o(1225),Object.defineProperty(t,"CheckboxField",{enumerable:!0,get:function(){return n.CheckboxField}}),a=o(991),Object.defineProperty(t,"InputField",{enumerable:!0,get:function(){return a.InputField}}),i=o(1226),Object.defineProperty(t,"InputFieldRegExp",{enumerable:!0,get:function(){return i.InputFieldRegExp}}),s=o(992),Object.defineProperty(t,"SaveRenameDialog",{enumerable:!0,get:function(){return s.SaveRenameDialog}})},1008:function(e,t){},1222:function(e,t,o){"use strict";var r,n=function(e,t,r){var a,i,s,l,c,p;e=$(e),r=r||{},r.activeClass=r.activeClass||"",a=(r.event||"click")+".popup-menu",r.hideEvent&&(i=r.hideEvent+".popup-menu"),s=function(){},l=s,c={},p=function(a,i,p){function u(t){var o=$(t.target).parents().andSelf();o.is(m)||o.is(e)||o.is(".charts-popup-tab-headers, .charts-popup-itemheader")||l()}function d(e){var t=$(e.target).parents().andSelf();t.is(".charts-popup-tab-headers, .charts-popup-itemheader")||r.notCloseOnButtons&&t.is(".icon-delete")||l()}function h(t,a,i){var s,l,c,p,u,d,f,b,g,y,v,_,w,P,T,C,k;if(t instanceof n.TabGroup){if(!t.tabs||!t.tabs.length)return;return 1!==t.tabs.length||t.tabs[0].title?(s=$('<div class="charts-popup-tab-group"></div>').appendTo(i),l=$('<div class="charts-popup-tab-headers"></div>').appendTo(s),c=null,void $.each(t.tabs||[],function(e,o){var r,n;o.items&&o.items.length&&(r=$('<div class="charts-popup-tab"></div>').hide().appendTo(s),$.each(o.items,function(){h(this,void 0,r)}),n=$('<span class="charts-popup-tab-header">').append($('<a href="javascript://" class="charts-popup-tab-header-label">').text(o.name)).appendTo(l),n.on("click",function(e){n.is(".active")||(l.find(".charts-popup-tab-header.active").removeClass("active"),n.addClass("active"),s.find(".charts-popup-tab").hide(),r.show(),e&&e.preventDefault(),"function"==typeof t.onChange&&t.onChange.call(t,o.name))}),c&&!o.active||(c=n,l.find(".charts-popup-tab-header.active").removeClass("active"),n.addClass("active"),s.find(".charts-popup-tab").hide(),r.show()))})):void $.each(t.tabs[0].items,function(){h(this,void 0,i)})}return t instanceof n.Group?(p=$('<div class="charts-popup-group"></div>').appendTo(i),t.title&&(u=$('<div class="charts-popup-itemheader"></div>').text(t.title).prepend($('<span class="charts-popup-itemheader-icon"></span>')),t.collapsible&&(p.addClass("charts-popup-group-collapsible"),p.toggleClass("collapsed",t.collapsed),u.on("click",function(){p.toggleClass("collapsed"),"function"==typeof t.onChange&&t.onChange(p.hasClass("collapsed")),m.height()===parseInt(m.css("max-height"))?m.addClass("popup-menu-scroll-y"):m.height()<parseInt(m.css("max-height"))&&m.removeClass("popup-menu-scroll-y")})),p.append(u)),void $.each(t.items,function(e){h(this,1,p)
})):t instanceof n.Header?void i.append($('<div class="charts-popup-itemheader"></div>').text(t.title)):t.separator?(d=$('<span class="separator"></span>'),void i.append(d)):(d=$('<a class="item" href="#">'),t.url&&d.attr("href",t.url),t.target&&d.attr("target",t.target),a||d.addClass("first"),"function"==typeof t.active?t.active(t)&&d.addClass("active"):t.active&&d.addClass("active"),t.addClass&&d.addClass(t.addClass),t.addData&&d.data(t.addData),t.disabled&&d.addClass("disabled"),"function"==typeof t.action&&(f=t.action,b=function(e){$(e.target).parents().andSelf().is(P)||(f.apply(d,arguments),!t.url&&e&&"function"==typeof e.preventDefault&&e.preventDefault())},r.upAction?d.bind("mouseup",b):d.bind("click",b)),t.date?(g=$('<span class="title"></span>').appendTo(d),$('<span class="date"></span>').text(t.date||"").appendTo(d)):t.icon&&!r.svg?(y=$('<span class="icon"></span>').appendTo(d),y.css("background-image",t.icon.image||""),t.icon.offset&&y.css("background-position","string"==typeof t.icon.offset?t.icon.offset:t.icon.offset.x+"px "+t.icon.offset.y+"px"),g=$('<span class="title"></span>').appendTo(d)):!0===r.svg&&t.svg?(r.wrapIcon?d.append($('<span class="icon-wrap">').addClass(t.iconClass).append(t.svg)):d.append(t.svg),g=$('<span class="title"></span>').appendTo(d)):t.iconClass?(d.append($('<span class="icon"></span>').addClass(t.iconClass)),g=$('<span class="title"></span>').appendTo(d)):g=$('<span class="title-expanded"></span>').appendTo(d),t.html?g.html(t.html):g.text(TradingView.clean(t.title,!0)||""),v=$('<span class="shortcut"></span>').appendTo(d),t.shortcut&&v.text(t.shortcut.keys),"function"==typeof t.deleteAction&&(_=t.deleteAction,w=t.deleteAction.title||$.t("Delete"),P=$('<span class="icon-delete">'),P.html(o(47)),P.attr("title",w),P.on("click",function(e){_.apply(d,arguments),e.preventDefault()}),d.append(P)),t.externalLink&&(T=$('<span class="icon-external">'),T.html(o(1227)),d.append(T)),t.buttons instanceof Array&&t.buttons.length&&t.buttons.forEach(function(e){e.el instanceof $||(e.el=$(e.el)),e.el.appendTo(d),e.handler&&e.el.on("click",function(t){e.handler.apply(d,arguments)})}),void 0!==t.counter&&("function"==typeof t.counter?(C=$('<span class="counter"></span>').html(t.counter()),C.appendTo(d)):(k=t.counterBlue?"blue":"",$('<span class="counter"></span>').text(t.counter+"").addClass(k).appendTo(d))),i.append(d),void e.data("popup-menu",i))}var f,m,b,g,y,v,_,w,P,T,C,k,S,x,O,D,E,I,N,A,L,j,M,V,H,F,z=a.target.ownerDocument,B=z.defaultView,U=i||t;if("function"==typeof U&&(U=U()),$(this).hasClass("open")||$(this).hasClass("active"))return a.preventDefault(),l(),void(f=c.scrollTop);switch(l=function(){c.scrollTop=m.scrollTop(),m.remove(),e.removeClass("active open "+r.activeClass),e.data("popup-menu",null),$(z).off("click",d),$(z).off("mousedown",u),Modernizr.touch&&$(z).off("touchstart.chartgui",u),$(z).off("selectstart.popup-menu"),l=s,r.onRemove&&r.onRemove()},e.addClass("active open "+r.activeClass),m=$('<div class="charts-popup-list">'),r.addClass&&m.addClass(r.addClass),
r.zIndex&&m.css("z-index",r.zIndex),b=m,r.listInner&&(b=$('<div class="list-inner">').appendTo(b)),r.listTable&&(b=$('<div class="list-table">').appendTo(b)),$.each(U,function(e){h(this,e,b)}),setTimeout(function(){$(z).on("click",d),$(z).on("mousedown",u),Modernizr.touch&&$(z).on("touchstart.chartgui",u)},0),r.upAction&&$(z).on("selectstart.popup-menu",function(){return!1}),m.appendTo(z.body),g=$(B).width(),y=Math.min($(B).height(),$("body").height()),v=e.outerWidth(),_=e.outerHeight(),w=e.offset(),f=$(B).scrollTop()||0,w.top-=f,w.top=Math.round(w.top),w.left=Math.round(w.left),P=m.outerWidth(),T=m.outerHeight(),C=void 0!==r.viewportSpacing?r.viewportSpacing:10,k=r.popupSpacing?~~r.popupSpacing:1,S=r.popupDrift?~~r.popupDrift:0,x=T-m.height(),O="down",r.direction&&(O="function"==typeof r.direction?r.direction():r.direction),D=!!r.reverse,"down"===O?(E=y-w.top-_-k-C-x,I=w.top-k-C-x,E<Math.max(T||0,100)&&I>E&&(O="up")):"right"===O&&(N=g-w.left-v-k-C-x,A=w.left-k-C-x,N<Math.max(P||0,100)&&A>N&&(O="left")),O){case"down":case"up":"down"===O?m.css("top",w.top+_+k+"px"):m.css("bottom",y-w.top+k+"px").css("top","auto"),D?m.css("left",Math.max(w.left+S+v-P,C)+"px").css("right","auto"):m.css("left",w.left+S+"px").css("right","auto");break;case"right":case"left":k=Math.max(k,4),"right"===O?m.css("left",Math.floor(w.left+v+k)+"px").css("right","auto"):m.css("left",Math.floor(Math.max(w.left-P-k,C))+"px").css("right","auto"),D?m.css("top",Math.floor(Math.max(w.top+S+_-T,C))+"px"):m.css("top",Math.floor(w.top+S)+"px")}for(m.show(),L=w.top,"up"===O||{left:1,right:1}[O]&&D?"up"!==O?L+=_:L-=_+k+x+C:L=y-L-_-2*k-x,m.height()>L&&m.addClass("popup-menu-scroll-y"),m.css("max-height",L+"px"),r.careRightBorder&&(j=g+$(B).scrollLeft(),parseInt(m.css("left"))+m.width()+C>j&&m.css("left",j-m.width()-C+"px").css("right","auto")),r.careBottomBorder&&parseInt(m.css("top"))+m.height()+C>y+f&&m.css("top",y-m.height()-C+f+"px"),V=e.parents().andSelf(),H=V.size();H--;)if("fixed"===V.eq(H).css("position")){M=V.eq(H);break}M&&(F=m.offset(),m.css({position:"fixed",left:F.left-$(z).scrollLeft(),right:"auto"})),m[0].scrollHeight>m.height()&&m.addClass("popup-with-scroll"),a&&a.preventDefault()},a&&e.bind(a,p),i&&e.bind(i,function(){l()}),r.runOpened&&p()};n.TabGroup=function e(t){if(!(this instanceof e))return new e(t);t=t||{},this.tabs=[],"function"==typeof t.onChange&&(this.onChange=t.onChange)},n.TabGroup.prototype.appendTab=function(e,t,o){if(null==e?e="":e+="",t||(t=[]),o||(o={}),!Array.isArray(t))throw new TypeError("items must be an array");return this.tabs.push({name:e,items:t,active:!!o.active}),t},n.Header=function e(t){if(!(this instanceof e))return new e(t);this.title=t},n.Group=function e(t){if(!(this instanceof e))return new e(t);t=t||{},this.items=[],this.title=null==t.title?"":t.title+"",this.collapsible=!!t.collapsible,this.collapsed=!!t.collapsed,"function"==typeof t.onChange&&(this.onChange=t.onChange)},n.Group.prototype.push=function(){this.items.push.apply(this.items,arguments)},t.bindPopupMenu=n,r=function(e){e=$(e),
e.unbind(".popup-menu"),e.removeData("popup-menu")},t.unbindPopupMenu=r},1224:function(e,t,o){"use strict";function r(e){var t,o;if(e&&e.__esModule)return e;if(t={},null!=e)for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a,i,s,l,c,p;Object.defineProperty(t,"__esModule",{value:!0}),t.AutocompleteField=void 0,a=function(){function e(e,t){var o,r;for(o=0;o<t.length;o++)r=t[o],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),i=o(9),s=r(i),l=o(110),c=r(l),p=o(781),t.AutocompleteField=function(){function e(t){var o,r=this,a=t.label,i=t.name,l=(t.maxLength,t.error),u=void 0===l?"":l,d=t.source;n(this,e),this._name=i,this._error=u,this._$field=$('<label class="tv-rename-chart-dialog__field">\n\t\t\t\t<span class="tv-rename-chart-dialog__label">'+a+"</span>\n\t\t\t</label>"),this._autocompleteContainer=document.createElement("div"),this._$field[0].appendChild(this._autocompleteContainer),o=s.createElement(p.Autocomplete,{source:d.map(function(e){return e.name}),allowUserDefinedValues:!0,preventOnFocusOpen:!0,noEmptyText:!0,preventSearchOnEmptyQuery:!0,setupHTMLInput:function(e){r._autocompleteInput=e},filter:function(e,t){return""===e||e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())}}),c.render(o,this._autocompleteContainer)}return a(e,[{key:"appendTo",value:function(e){e.append(this._$field)}},{key:"focus",value:function(){this._autocompleteInput.focus()}},{key:"select",value:function(){this._autocompleteInput.focus(),this._autocompleteInput.select()}},{key:"unmount",value:function(){c.unmountComponentAtNode(this._autocompleteContainer)}},{key:"value",get:function(){return this._autocompleteInput.value}},{key:"name",get:function(){return this._name}},{key:"valid",get:function(){return!!this._autocompleteInput.value}},{key:"error",get:function(){return this._error}}]),e}()},1225:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a,i,s;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckboxField=void 0,a=function(){function e(e,t){var o,r;for(o=0;o<t.length;o++)r=t[o],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),i=o(62),s=r(i),t.CheckboxField=function(){function e(t){var o=t.label,r=t.name,a=t.error,i=void 0===a?"":a,l=t.hint;n(this,e),this._name=r,this._error=i,this._checkboxView=new s.default({labelRight:o,name:r}),this._checkboxView.$el.addClass("tv-rename-chart-dialog__field"),l&&this._checkboxView.$el.append('<span class="tv-rename-chart-dialog__hint apply-common-tooltip" title=\''+l+"'></span>")}return a(e,[{key:"appendTo",value:function(e){e.append(this._checkboxView.$el)}},{key:"focus",
value:function(){}},{key:"select",value:function(){}},{key:"value",set:function(e){this._checkboxView.checked=e},get:function(){return this._checkboxView.checked}},{key:"name",get:function(){return this._name}},{key:"valid",get:function(){return!0}},{key:"error",get:function(){return this._error}}]),e}()},1226:function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i,s;Object.defineProperty(t,"__esModule",{value:!0}),t.InputFieldRegExp=void 0,i=function(){function e(e,t){var o,r;for(o=0;o<t.length;o++)r=t[o],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),s=o(1007),t.InputFieldRegExp=function(e){function t(e){var o,a;return r(this,t),o=e.regExp,delete e.regExp,a=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),a._regExp=o,a}return a(t,e),i(t,[{key:"valid",get:function(){return this._regExp.test(this._$input.val())}}]),t}(s.InputField)},1227:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 11" width="11" height="11"><path fill="none" fill-rule="evenodd" stroke="#9DB2BD" d="M10.5 6v3.5a1 1 0 0 1-1 1h-8a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1H5m5.5 0L6 5M7 .5h3.5V4"/></svg>'},1247:function(e,t,o){"use strict";function r(e,t){var o,a;return void 0===t&&(t=[]),(o=n[e])?l.test(o)?o:(a=o,t.push(e),-1!==t.indexOf(a)?(console.warn("Colors definitions cycled"),o):t.length>s?(console.warn("Too many variables-link in HEX-color search: "+t[0]),null):r(a,t)):null}var n,a,i,s,l;Object.defineProperty(t,"__esModule",{value:!0}),n=o(1248),a=o(21),i={},s=Object.keys(n).length,l=/^#[0-9A-F]{6}$/i,Object.keys(n).forEach(function(e){var t=r(e);i[e]=a.ensureNotNull(t)}),t.colorsPalette=i},1248:function(e,t){e.exports={"color-aqua-spring":"#ebf9f5","color-army-green":"#3d2c12","color-army-green-2":"#31230d","color-athens-gray-1":"#f2f3f5","color-athens-gray-2":"#f7f8fa","color-athens-gray-3":"#eceff2","color-black":"#000000","color-blue-dianne":"#21384d","color-bright-gray":"#363c4e","color-carnation":"#f04561","color-catskill-white":"#e1ecf2","color-charade":"#2f3241","color-charcoal-grey":"#323337","color-curious-blue":"#299dcd","color-dark-blue-grey":"#123440","color-dark-grey":"#292a2d","color-dark-grey-blue":"#28415a","color-dark-sky-blue":"#37a6ef","color-dark-slate-blue":"#194453","color-deep-sea-blue":"#016087","color-medium-blue":"#2E7BB2","color-ebony-clay":"#262b3e","color-foam":"#d7f0fb","color-gull-gray":"#9db2bd",
"color-humming-bird":"#d3eef9","color-keppel-1":"#37bc9b","color-keppel-2":"#34b293","color-lavender-blush":"#ffedf0","color-loblolly":"#c5cbce","color-manatee":"#878ca8","color-mandy":"#eb4d5c","color-milk-chocolate":"#6f2626","color-mirage-1":"#131722","color-mirage-2":"#171b29","color-mirage-3":"#1c2030","color-mischka":"#d6d8e0","color-morning-glory":"#9addcc","color-oslo-gray":"#8b8e95","color-pale":"#fff2cf","color-pale-sky":"#6b7988","color-picton-blue-1":"#3bb3e4","color-picton-blue-2":"#41bef1","color-puerto-rico":"#3bc2a1","color-purple-brown":"#4e2934","color-purple-brown-2":"#3d2028","color-radical-red":"#ff4a68","color-regent-gray":"#8797a5","color-scooter":"#38acdb","color-silver-tree":"#53b987","color-slate-gray":"#758696","color-sundown":"#ffa4b3","color-sunglow":"#ffca3b","color-tan-hide":"#ff9850","color-trout-1":"#4c525e","color-trout-2":"#4f5966","color-violet-1":"#332738","color-violet-2":"#271d2b","color-water-blue":"#1592e6","color-white":"#ffffff","color-white-ice":"#ebf7fc","color-wild-watermelon":"#ff5773","color-brownish-grey":"#8d6e63","color-lightish-purple":"#a75ee8","color-active-hover-text":"color-black","color-alert-bg":"color-white","color-alert-text":"color-black","color-border-table":"color-athens-gray-3","color-brand":"color-picton-blue-1","color-brand-active":"color-curious-blue","color-brand-hover":"color-scooter","color-brand-light":"color-picton-blue-2","color-chart-page-bg":"color-athens-gray-3","color-common-tooltip-bg":"color-ebony-clay","color-common-tooltip-text":"color-athens-gray-1","color-danger":"color-radical-red","color-depthrenderer-stroke-style":"color-athens-gray-1","color-highlight-new":"color-pale","color-input-bg":"color-white","color-input-publish-bg":"color-white","color-link":"color-brand","color-list-nth-child-bg":"color-athens-gray-2","color-pane-bg":"color-white","color-popup-bg":"color-white","color-popup-menu-item-hover-bg":"color-white-ice","color-popup-menu-separator":"color-catskill-white","color-replay-data-mode":"color-radical-red","color-screener-header-bg":"color-athens-gray-2","color-screener-description":"color-trout-2","color-success":"color-keppel-1","color-toolbar-button-text-active":"color-water-blue","color-toolbar-interactive-element-text-normal":"color-trout-1","color-toolbar-interactive-element-text-hover":"color-mirage-1","color-toolbar-opened-element-bg":"color-athens-gray-2","color-tooltip-bg":"color-ebony-clay","color-tv-dialog-caption":"color-trout-2","color-tv-dropdown-item-hover-bg":"color-athens-gray-1","color-underlined-text":"color-slate-gray","color-widget-pages-bg":"color-white","color-growing":"color-keppel-1","color-falling":"color-radical-red","color-label-long":"color-success","color-label-short":"color-danger","color-label-education":"color-sunglow","color-label-neutral":"color-gull-gray","color-collapse-tabs-border":"color-athens-gray-3","color-forex-icon":"color-bright-gray","color-list-item-active-bg":"color-dark-sky-blue","color-list-item-hover-bg":"color-white-ice","color-list-item-text":"color-ebony-clay",
"color-border":"#dadde0","color-border-chat-fields":"#c9cbcd","color-border-hover":"#c8c8c8","color-button-hover-bg":"#f2f2f2","color-depthrenderer-fill-style":"#555555","color-disabled-border-and-color":"#ececec","color-disabled-input":"#ececec","color-empty-container-message":"#8a8a8a","color-footer-chart-panel-bg":"#f1f3f6","color-icons":"#7d7d7d","color-input-textarea-readonly":"#555555","color-item-active-blue":"#eff9ff","color-item-hover-active-bg":"#f1f3f6","color-item-hover-bg":"#edf1f2","color-item-hover-blue":"#c6e9f8","color-item-selected-blue":"#eafafe","color-list-item":"#888989","color-news-highlight":"#f2f5f8","color-placeholder":"#adaeb0","color-row-hover-active-bg":"#f1f3f6","color-sb-scrollbar-body-bg":"#d8d8d8","color-screener-header-bg-hover":"#f1f3f6","color-section-separator-border":"#b5b7b9","color-separator-table-chat":"#eaecef","color-tag-active-bg":"#cfdce3","color-tag-hover-bg":"#dce6ea","color-text-regular":"#4a4a4a","color-text-secondary":"#b4b4b4","color-tv-button-checked":"#757575","color-white-theme-tooltip-text":"#333333","color-white-theme-tooltip-border":"#d6d6d6","color-seeking-alpha-brand":"#ff7200"}},1327:function(e,t,o){"use strict";(function(t){function r(e,t,o){this._source=e,this._model=t,this._undoCheckpoint=o,this._themeCheckpoint=h().name}var n=o(89).LineDataSource,a=o(511).Study,i=o(604),s=o(526).DataSource,l=o(107),c=o(1222).bindPopupMenu,p=o(3033),u=o(525).Version,d=o(3540),h=o(479).getCurrentTheme,f=o(479).setTheme,m=o(479).syncTheme,b=o(15).trackEvent;o(174),r.prototype.hide=function(e){TVDialogs.destroy(this._dialogTitle,{undoChanges:!!e})},r.prototype._onDestroy=function(e,t){var o,r,n,i=(t||{}).undoChanges;$(window).unbind("keyup.hidePropertyDialog"),i?(o=this._undoCheckpoint?this._undoCheckpoint:this._undoCheckpointOnShow)&&this._model.undoToCheckpoint(o):this._source.hasAlert.value()&&(r=this._source,setTimeout(function(){r.localAndServerAlersMismatch&&r.synchronizeAlert(!0)})),this._undoCheckpointOnShow&&delete this._undoCheckpointOnShow,window.lineToolPropertiesToolbar&&window.lineToolPropertiesToolbar.refresh(),TradingView.isInherited(this._source.constructor,a)&&(n=this._model.paneForSource(this._source))&&n.updateAlertLabelsSources()},r.prototype.isVisible=function(){return this._dialog&&this._dialog.is(":visible")},r.prototype.focusOnText=function(){this._dialog.find('input[type="text"]').focus().select()},r.prototype.switchTab=function(e,t){var o,r;if(this._tabs)return o=null,e?e=e.valueOf():null===e&&(e=void 0),"string"==typeof e&&$.each(this._tabs,function(t,r){if(r.name===e)return o=r,!1}),"object"==typeof e&&$.each(this._tabs,function(t,r){if(e===r||$(r.labelObject).is(e)||$(r.wrapperObject).is(e))return o=r,!1}),o||(o=this._tabs[~~e]),!!o&&($.each(this._tabs,function(e,t){var r=t===o;$(t.wrapperObject)[r?"show":"hide"](),$(t.labelObject)[r?"addClass":"removeClass"]("active")}),t&&(r=this.activeTabSettingsName())&&TVSettings.setValue(r,o.name),this._dialog.height()+100>$(window).height()&&!o.isScrollable&&this.makeScrollable(o),$(":focus").blur(),!0)},
r.prototype.makeScrollable=function(e){var t=e.wrapperObject,o=$(e.objects[0]),r=o.width();t.css({height:$(window).height()/1.4,overflow:"auto"}),o.css("width",r+20),e.isScrollable=!0},r.prototype.appendToTab=function(e,t,o,r,n,a){var i,s;$(e).is("table")&&!$(e).find("tr").size()||(this._tabs||(this._tabs=[]),$.each(this._tabs,function(e,o){if(o.name===t)return i=e,!1}),void 0===i&&(this._tabs.push({name:t,localizedName:$.t(t),objects:$(),displayPriority:0,defaultOpen:0,isButton:!!n,callback:n?a||function(){}:null}),i=this._tabs.length-1),s=this._tabs[i],s.objects=s.objects.add(e),s.displayPriority=Math.max(s.displayPriority||0,o||0),s.defaultOpen=Math.max(s.defaultOpen||0,r||0))},r.prototype.insertTabs=function(){function e(e){a&&a===e.name&&(e.defaultOpen=Math.max(~~e.defaultOpen,p.TabOpenFrom.UserSave)),(!r||~~r.defaultOpen<~~e.defaultOpen)&&(r=e),e.labelObject=$('<a href="#" class="properties-tabs-label tv-tabs__tab"></a>').text(e.localizedName).appendTo(o._tabContainer),e.labelObject.on("mousedown",function(e){function t(e){var t=5;return Math.abs(n-e.pageX)>t||Math.abs(a-e.pageY)>t}function r(e){i=i||t(e)}var n=e.pageX,a=e.pageY,i=!1,s=this;$(s).on("mousemove",r),$(s).one("mouseup",function(){i||o.switchTab(s,!0),$(s).off("mousemove",r)})});var t=$('<div class="main-properties"></div>');e.wrapperObject=$().add(t),e.objects.each(function(o,r){var n=$(r);n.is("table")?(n.data("layout-separated")&&(e.wrapperObject=e.wrapperObject.add('<div class="properties-separator"></div>').add(t=$('<div class="main-properties"></div>')),n.removeData("layout-separated")),t.append(n),n.children("tbody").each(function(o,n){if(0!==o&&$(n).data("layout-separated")){e.wrapperObject=e.wrapperObject.add('<div class="properties-separator"></div>').add(t=$('<div class="main-properties"></div>'));var a=$(r).clone(!0,!1).appendTo(t);a.children().remove(),a.append(n),$(n).removeData("layout-separated")}})):t.append(n)}),e.wrapperObject.appendTo(o._container)}function t(e){e.labelObject=$('<a href="#" class="properties-tabs-label tv-tabs__tab"></a>').text(e.localizedName).appendTo(o._tabContainer),e.labelObject.bind("click",e.callback)}var o,r,n,a;this._tabs&&(this._tabs.sort(function(e,t){return(t.displayPriority||0)-(e.displayPriority||0)}),o=this,r=null,n=this.activeTabSettingsName(),n&&(a=TVSettings.getValue(n)),$.each(this._tabs,function(o,r){r.isButton?t(r):e(r)}),this.switchTab(r))},r.prototype.activeTabSettingsName=function(){var e=this._source;if(e)return e instanceof i?"properties_dialog.active_tab.chart":e instanceof n?"properties_dialog.active_tab.drawing":e instanceof a?"properties_dialog.active_tab.study":void 0},r.prototype.show=function(e){function r(){C.hide(!0),f(C._themeCheckpoint),m()}var g,y,v,_,w,P,T,C,k,S,x,O,D,E,I,N,A,L,j,M,V,H,F,z,B,U,W,R,G;if(t.enabled("property_pages")&&(g=o(2132),e=e||{},y=e.onWidget||!1,TradingView.isInherited(this._source.constructor,i)&&b("GUI","Series Properties"),TradingView.isInherited(this._source.constructor,a)&&b("GUI","Study Properties"),
TradingView.isInherited(this._source.constructor,s)&&this._model.setSelectedSource(this._source),v=g.createStudyStrategyPropertyPage(this._source,this._model),_=g.createInputsPropertyPage(this._source,this._model),w=g.createStylesPropertyPage(this._source,this._model),P=g.createVisibilitiesPropertyPage(this._source,this._model),T=g.createDisplayPropertyPage(this._source,this._model),_&&!_.widget().is(":empty")||w||v))return C=this,k=null!==_,S=this._source.title(),x=e.ownerDocument||this._model._chartWidget.widget().prop("ownerDocument"),O=TVDialogs.createDialog(S,{hideTitle:!0,dragHandle:".properties-tabs",ownerDocument:x}),D=O.find("._tv-dialog-content"),E=$('<div class="properties-tabs tv-tabs"></div>').appendTo(D),null!==w&&!0===w.supportThemeSwitcher&&(I=d.createThemeSwitcher(w,this._model.mainSeries().properties(),w._property)),N=[],A=400,this._tabs=N,this._dialog=O,this._dialogTitle=S,this._container=D,this._tabContainer=E,this._undoCheckpointOnShow=this._model.createUndoCheckpoint(),O.on("destroy",function(e,t){var t=t||{};C._onDestroy(e,t),I&&(t.undoChanges?I.restore():I.applyTheme()),_&&_.destroy(),v&&v.destroy(),w&&w.destroy(),T&&T.destroy(),P&&P.destroy(),$("select",D).each(function(){$(this).selectbox("detach")})}),e.selectScales&&w.setScalesOpenTab&&w.setScalesOpenTab(),e.selectTmz&&w.setTmzOpenTab&&w.setTmzOpenTab(),!this._model.readOnly()&&v&&v.widget().each(function(e,t){var o,r,n=+$(t).data("layout-tab-priority");isNaN(n)&&(n=p.TabPriority.Properties),o=~~$(t).data("layout-tab-open"),r=$(t).data("layout-tab"),void 0===r&&(r=p.TabNames.properties),C.appendToTab(t,r,n,o)}),this._model.readOnly()||!k||_.widget().is(":empty")||_.widget().each(function(e,t){var r,n,a=o(2088),i=_ instanceof a,s=+$(t).data("layout-tab-priority");TradingView.isNaN(s)&&(s=i?p.TabPriority.Coordinates:p.TabPriority.Inputs),r=~~$(t).data("layout-tab-open"),n=$(t).data("layout-tab"),void 0===n&&(n=i?p.TabNames.coordinates:p.TabNames.inputs),C.appendToTab(t,n,s,r)}),w&&w.widget().each(function(e,t){var r,n,a,i=+$(t).data("layout-tab-priority");TradingView.isNaN(i)&&(i=p.TabPriority.Style),r=~~$(t).data("layout-tab-open"),n=o(3015),!r&&w instanceof n&&(r=p.TabOpenFrom.Default),a=$(t).data("layout-tab"),void 0===a&&(a=p.TabNames.style),C.appendToTab(t,a,i,r)}),T&&T.widget().each(function(e,t){var o,r,n=+$(t).data("layout-tab-priority");TradingView.isNaN(n)&&(n=p.TabPriority.Display),o=~~$(t).data("layout-tab-open"),r=$(t).data("layout-tab"),void 0===r&&(r=p.TabNames.properties),C.appendToTab(t,r,n,o)}),P&&P.widget().each(function(e,t){C.appendToTab(t,p.TabNames.visibility,p.TabPriority.Display,!1)}),M=this._source instanceof a&&!!this._source.metaInfo().pine,M&&(V=this._source.metaInfo(),H=o(509),H.isAuthToGetPineSourceCode(V.scriptIdPart,V.pine.version).done(function(e){e&&C.appendToTab(null,p.TabNames.sourceCode,null,null,!0,function(){C.hide(),H.getPineSourceCode(V.scriptIdPart,V.pine.version).done(function(e){var t=u.parse(e.version),o=e.lastVersionMaj?u.parse(e.lastVersionMaj):new u(0,0),r={scriptSource:e.source,
scriptIdPart:V.scriptIdPart,scriptName:e.scriptName,scriptTitle:e.scriptTitle,version:e.version,isOld:!o.isZero()&&o.major()!==t.major()};TradingView.bottomWidgetBar&&TradingView.bottomWidgetBar.activateScriptEditorTab(r)})})})),F=t.enabled("alerts")&&this._source.canHasAlert(),F&&C.appendToTab(null,$.t("Alert"),null,null,!0,function(){runOrSignIn(function(){if(C.hide(),C._source.hasAlert.value())C._source.editAlert();else{new(0,o(599).MakeAlertDialog)({drawing:C._source})}},{source:"Alert add from object properties dialog"})}),this.insertTabs(),this._helpItemRequired()&&this._createHelp(),z=110,$(".js-dialog").each(function(){var e=parseInt($(this).css("z-index"),10);e>z&&(z=e)}),O.css("z-index",z),L=$('<div class="main-properties main-properties-aftertabs"></div>').appendTo(D),j=$('<div class="dialog-buttons">').appendTo(L),B=function(){function e(t){t._childs&&t._childs.length&&$.each(t._childs,function(o,r){"percentage"===r?t.percentage.listeners().fire(t.percentage):e(t[r])})}var t=[];w&&"function"==typeof w.defaultProperties&&(t=t.concat(w.defaultProperties())),_&&"function"==typeof _.defaultProperties&&(t=t.concat(_.defaultProperties())),0===t.length&&C._source.properties?t=[C._source.properties()]:C._source._sessionsStudy&&(t=t.concat(C._source._sessionsStudy.properties())),t.length&&($.each(t,function(t,o){"chartproperties"===o._defaultName?"dark"===h().name&&w.loadTheme("Dark",!0,!0):C._source instanceof n?C._model.restoreLineToolFactoryDefaults(C._source,"Load default drawing template"):C._source instanceof a?C._model.restoreDefaults(o):C._model.restoreFactoryDefaults(o),C._source.calcIsActualSymbol&&C._source.calcIsActualSymbol(),e(o)}),C._source.properties().minTick&&C._source.properties().minTick.listeners().fire(C._source.properties().minTick),C._source.properties().precision&&C._source.properties().precision.listeners().fire(C._source.properties().precision),_&&_.loadData(),v&&v.loadData(),w.onResoreDefaults&&w.onResoreDefaults(),w&&w.loadData(),P&&P.loadData(),I&&"dark"!==h().name&&I.restoreDefault())},U=function(){P&&P.loadData(),_&&_.loadData()},(!y||window.is_authenticated)&&w&&"function"==typeof w.createTemplateButton&&t.enabled("linetoolpropertieswidget_template_button")?(I&&j[0].appendChild(I.domNode),w.createTemplateButton({popupZIndex:z,defaultsCallback:B,loadTemplateCallback:U}).addClass("tv-left").appendTo(j)):TradingView.isInherited(this._source.constructor,a)?(W=[{title:$.t("Reset Settings"),action:B},{title:$.t("Save As Default"),action:function(){C._source.properties().saveDefaults()}}],R=$('<a href="#" class="_tv-button tv-left">'+$.t("Defaults")+'<span class="icon-dropdown"></span></a>'),R.on("click",function(e){e.preventDefault();var t=$(this);t.is(".active")||t.trigger("button-popup",[W,!0])}).appendTo(j),c(R,null,{direction:"down",event:"button-popup",notCloseOnButtons:!0,zIndex:z})):$('<a class="_tv-button tv-left">'+$.t("Defaults")+"</a>").appendTo(j).click(B),$('<a class="_tv-button ok">'+$.t("OK")+"</a>").appendTo(j).click(function(){C.hide()}),
$('<a class="_tv-button cancel">'+$.t("Cancel")+"</a>").appendTo(j).on("click",r),O.find("._tv-dialog-title a").on("click",r),$(window).bind("keyup.hidePropertyDialog",function(e){13===e.keyCode&&"textarea"!==e.target.tagName.toLowerCase()&&C.hide()}),$("select",D).each(function(){var e=$(this),t="tv-select-container dialog";e.hasClass("tv-select-container-fontsize")&&(t+=" tv-select-container-fontsize"),e.selectbox({speed:100,classHolder:t})}),$('input[type="text"]',D).addClass("tv-text-input inset dialog"),$("input.ticker",D).TVTicker(),O.css("min-width",A+"px"),TVDialogs.applyHandlers(O,e),G={top:($(window).height()-O.height())/2,left:($(window).width()-O.width())/2},w&&"function"==typeof w.dialogPosition&&(G=w.dialogPosition(G,O)||G),TVDialogs.positionDialog(O,G),window.lineToolPropertiesToolbar&&window.lineToolPropertiesToolbar.hide(),l.emit("edit_object_dialog",{objectType:this._source===this._model.mainSeries()?"mainSeries":this._source instanceof n?"drawing":this._source instanceof a?"study":"other",scriptTitle:this._source.title()}),O},r.prototype._helpItemRequired=function(){return this._source._metaInfo&&!!this._source._metaInfo.helpURL},r.prototype._createHelp=function(){var e=$('<a class="help" href="#" target="_blank" title="'+$.t("Help")+'"></a>');e.attr("href",this._source._metaInfo.helpURL),this._tabContainer.prepend(e)},e.exports=r}).call(t,o(5))},2088:function(e,t,o){"use strict";function r(e,t,o){a.call(this,e,t),this._linetool=o,this.prepareLayout()}var n=o(1221),a=n.PropertyPage,i=n.GreateTransformer,s=n.LessTransformer,l=n.ToIntTransformer,c=n.SimpleStringBinder;o(174),inherit(r,a),r.BarIndexPastLimit=-5e4,r.BarIndexFutureLimit=15e3,r.prototype.bindBarIndex=function(e,t,o,n){var a=[l(e.value()),i(r.BarIndexPastLimit),s(r.BarIndexFutureLimit)];this.bindControl(this.createStringBinder(t,e,a,!0,o,n))},r.prototype.createPriceEditor=function(e){var t,o,r,n=this._linetool,a=n.ownerSource().formatter(),i=function(e){return a.format(e)},s=function(e){var t=a.parse(e);if(t.res)return t.price?t.price:t.value},l=$("<input type='text'>");return l.TVTicker({step:a._minMove/a._priceScale||1,formatter:i,parser:s}),e&&(t=[function(t){var o=s(t);return void 0===o?e.value():o}],o="Change "+n.title()+" point price",r=this.createStringBinder(l,e,t,!1,this.model(),o),r.addFormatter(function(e){return a.format(e)}),this.bindControl(r)),l},r.prototype._createPointRow=function(e,t,o){var r,n,a,i,s,l=$("<tr>"),c=$("<td>");return c.html($.t("Price")+o),c.appendTo(l),r=$("<td>"),r.appendTo(l),n=this.createPriceEditor(t.price),n.appendTo(r),a=$("<td>"),a.html($.t("Bar #")),a.appendTo(l),i=$("<td>"),i.appendTo(l),s=$("<input type='text'>"),s.appendTo(i),s.addClass("ticker"),this.bindBarIndex(t.bar,s,this.model(),"Change "+this._linetool.title()+" point bar index"),l},r.prototype.prepareLayoutForTable=function(e){var t,o,r,n,a,i=this._linetool.points(),s=i.length;for(t=0;t<i.length;t++)o=i[t],(r=this._linetool.properties().points[t])&&(n=t||s>1?" "+(t+1):"",a=this._createPointRow(o,r,n),a.appendTo(e))},
r.prototype.prepareLayout=function(){this._table=$(document.createElement("table")),this._table.addClass("property-page"),this._table.attr("cellspacing","0"),this._table.attr("cellpadding","2"),this.prepareLayoutForTable(this._table),this.loadData()},r.prototype.widget=function(){return this._table},r.prototype.createStringBinder=function(e,t,o,r,n,a){return new c(e,t,o,r,n,a)},e.exports=r},2090:function(e,t){e.exports={"color-active-hover-text":"color-gull-gray","color-alert-bg":"color-mirage-1","color-alert-text":"color-loblolly","color-border":"color-bright-gray","color-border-chat-fields":"color-bright-gray","color-border-hover":"color-trout-1","color-border-table":"color-bright-gray","color-brand":"color-picton-blue-1","color-brand-active":"color-curious-blue","color-brand-hover":"color-scooter","color-button-hover-bg":"color-mirage-3","color-chart-page-bg":"color-charade","color-common-tooltip-text":"color-loblolly","color-common-tooltip-bg":"color-trout-2","color-depthrenderer-fill-style":"color-catskill-white","color-depthrenderer-stroke-style":"color-trout-1","color-disabled-border-and-color":"color-ebony-clay","color-disabled-input":"color-bright-gray","color-empty-container-message":"color-slate-gray","color-footer-chart-panel-bg":"color-mirage-3","color-highlight-new":"color-dark-slate-blue","color-icons":"color-slate-gray","color-input-bg":"color-charade","color-input-textarea-readonly":"color-trout-1","color-input-publish-bg":"color-mirage-1","color-item-active-blue":"color-blue-dianne","color-item-hover-active-bg":"color-charade","color-item-hover-bg":"color-ebony-clay","color-item-hover-blue":"color-blue-dianne","color-item-selected-blue":"color-blue-dianne","color-link":"color-curious-blue","color-list-item":"color-slate-gray","color-list-nth-child-bg":"color-mirage-3","color-news-highlight":"color-charade","color-pane-bg":"color-mirage-1","color-placeholder":"color-trout-2","color-popup-bg":"color-mirage-3","color-popup-menu-item-hover-bg":"color-ebony-clay","color-popup-menu-separator":"color-bright-gray","color-row-hover-active-bg":"color-ebony-clay","color-sb-scrollbar-body-bg":"color-trout-2","color-screener-header-bg":"color-mirage-3","color-screener-header-bg-hover":"color-ebony-clay","color-screener-description":"color-loblolly","color-section-separator-border":"color-bright-gray","color-separator-table-chat":"color-bright-gray","color-tag-active-bg":"color-bright-gray","color-tag-hover-bg":"color-charade","color-text-regular":"color-loblolly","color-text-secondary":"color-trout-1","color-toolbar-button-text-active":"color-picton-blue-1","color-toolbar-interactive-element-text-normal":"color-slate-gray","color-toolbar-interactive-element-text-hover":"color-gull-gray","color-toolbar-opened-element-bg":"color-mirage-3","color-tooltip-bg":"color-bright-gray","color-tv-button-checked":"color-slate-gray","color-tv-dialog-caption":"color-athens-gray-2","color-tv-dropdown-item-hover-bg":"color-charade","color-underlined-text":"color-gull-gray","color-widget-pages-bg":"color-mirage-2",
"color-forex-icon":"color-white","color-list-item-active-bg":"color-medium-blue","color-list-item-hover-bg":"color-ebony-clay","color-list-item-text":"color-loblolly"}},2091:function(e,t){e.exports={"color-toolbar-button-text-active":"color-seeking-alpha-brand"}},2132:function(e,t,o){"use strict";t.createInputsPropertyPage=function(e,t){var o=e.getInputsPropertyPage();return null==o?null:new o(e.properties(),t,e)},t.createStudyStrategyPropertyPage=function(e,t){var o=e.getStrategyPropertyPage();return null==o?null:new o(e.properties(),t,e)},t.createStylesPropertyPage=function(e,t){var o=e.getStylesPropertyPage();return null==o?null:new o(e.properties(),t,e)},t.createDisplayPropertyPage=function(e,t){var o=e.getDisplayPropertyPage();return null==o?null:new o(e.properties(),t,e)},t.createVisibilitiesPropertyPage=function(e,t){var o=e.getVisibilitiesPropertyPage();return null==o?null:new o(e.properties(),t,e)},t.hasInputsPropertyPage=function(e){return null!==e.getInputsPropertyPage()},t.hasStylesPropertyPage=function(e){return null!==e.getStylesPropertyPage()}},3015:function(e,t,o){"use strict";function r(e){function t(t,o,r){e.call(this,t,o,r),this._linetool=r,this._templateList=new c(this._linetool._constructor,this.applyTemplate.bind(this))}return inherit(t,e),t.prototype.applyTemplate=function(e){this.model().applyLineToolTemplate(this._linetool,e,"Apply Drawing Template"),this.loadData()},t.prototype.createTemplateButton=function(e){var t=this;return e=$.extend({},e,{getDataForSaveAs:function(){return t._linetool.template()}}),this._templateList.createButton(e)},t}function n(e,t,o){i.call(this,e,t),this._linetool=o}var a=o(1221),i=a.PropertyPage,s=a.ColorBinding,l=o(1223).addColorPicker,c=o(3077);inherit(n,i),n.prototype.createOneColorForAllLinesWidget=function(){var e=$("<td class='colorpicker-cell'>");return this.bindControl(new s(l(e),this._linetool.properties().collectibleColors,!0,this.model(),"Change All Lines Color",0)),{label:$("<td>"+$.t("Use one color")+"</td>"),editor:e}},n.prototype.addOneColorPropertyWidget=function(e){var t=this.createOneColorForAllLinesWidget(),o=$("<tr>");o.append($("<td>")).append(t.label).append(t.editor),o.appendTo(e)},n=r(n),n.createTemplatesPropertyPage=r,e.exports=n},3033:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Coordinates=100]="Coordinates",e[e.Display=100]="Display",e[e.Style=200]="Style",e[e.Inputs=300]="Inputs",e[e.Properties=250]="Properties"}(t.TabPriority||(t.TabPriority={})),function(e){e.background="Background",e.coordinates="Coordinates",e.drawings="Drawings",e.events="Events",e.eventsAndAlerts="Events & Alerts",e.inputs="Inputs",e.properties="Properties",e.scales="Scales",e.sourceCode="Source Code",e.style="Style",e.timezoneSessions="Timezone/Sessions",e.trading="Trading",e.visibility="Visibility"}(t.TabNames||(t.TabNames={})),function(e){e[e.Default=100]="Default",e[e.UserSave=200]="UserSave",e[e.Override=300]="Override"}(t.TabOpenFrom||(t.TabOpenFrom={}))},3077:function(e,t,o){"use strict";(function(t){
function r(e,o,r){var n={saveAsText:$.t("Save As..."),applyDefaultText:$.t("Apply Defaults")};this._toolName=e,this._applyTemplate=o,this._options=$.extend(n,r||{}),this._list=[],t.enabled("charting_library_base")||(this.templatesDeferred=this.loadData())}var n=o(1222).bindPopupMenu,a=o(1007),i=a.SaveRenameDialog,s=a.InputField,l=o(517).createConfirmDialog,c=o(0).getLogger("Chart.LineToolTemplatesList");r._cache={},r.prototype.getData=function(){return this._list},r.prototype.loadData=function(){var e=this;return this._toolName in r._cache?(this._list=r._cache[this._toolName],$.Deferred().resolve()):$.get("/drawing-templates/"+this._toolName+"/",function(t){e._list=t,r._cache[e._toolName]=t}).error(function(){c.logWarn("Failed to load drawing template: "+e._toolName)})},r.prototype.templatesLoaded=function(){return this.templatesDeferred},r.prototype.invalidateToolCache=function(){delete r._cache[this._toolName]},r.prototype.createButton=function(e){var t,o=this;return e=$.extend({},e,o._options),t=$("<a></span></a>").addClass(e.buttonClass?e.buttonClass:"_tv-button").html(e.buttonInner?e.buttonInner:$.t("Template")+'<span class="icon-dropdown">'),n(t,null,{event:"button-popup",zIndex:e.popupZIndex,activeClass:e.popupActiveClass,direction:e.popupDirection}),t.bind("click",function(t){var r,n,a;t.stopPropagation(),$(this).is("active")||(r=[],"function"==typeof e.getDataForSaveAs&&(n=function(t){var r=JSON.stringify(e.getDataForSaveAs());o.saveTemplate(t,r)},r.push({title:e.saveAsText,action:o.showSaveDialog.bind(o,n),addClass:"special"})),"function"==typeof e.defaultsCallback&&r.push({title:e.applyDefaultText,action:e.defaultsCallback,addClass:"special"}),a=[],$.each(o._list,function(t,r){a.push({title:r,action:function(){o.loadTemplate.call(o,r,e.loadTemplateCallback)},deleteAction:function(){runOrSignIn(function(){var e=$.t("Do you really want to delete Drawing Template '{0}' ?").format(r),t=l({type:"modal",content:e});t.on("action:yes",function(e){o.removeTemplate.call(o,r),e.close()}),t.open()},{source:"Delete line tool template"})}})}),a.length&&(a.sort(function(e,t){return e=e.title.toUpperCase(),t=t.title.toUpperCase(),e===t?0:e>t?1:-1}),r.push({separator:!0}),r=r.concat(a)),$(this).trigger("button-popup",[r]))}),t},r.prototype.loadTemplate=function(e,t){var o=this;return $.get("/drawing-template/"+this._toolName+"/?templateName="+encodeURIComponent(e),function(e){o._applyTemplate(JSON.parse(e.content)),t&&t()}).error(function(e){c.logWarn(e.responseText)})},r.prototype.removeTemplate=function(e){if(e){var t=this;$.post("/remove-drawing-template/",{name:e,tool:t._toolName}).error(function(e){c.logWarn(e.responseText)}),t.invalidateToolCache(),t._list=$.grep(t._list,function(t){return t!==e})}},r.prototype.saveTemplate=function(e,t){var o,r,n,a,i=this;e&&t&&(e=TradingView.clean(e),o=-1!==$.inArray(e,i._list),r=function(){var r={name:e,tool:i._toolName,content:t},n=function(){o||i._list.push(e)};$.post("/save-drawing-template/",r,n).error(function(e){c.logWarn(e.responseText)}),i.invalidateToolCache()},
o?(n=$.t("Drawing Template '{0}' already exists. Do you really want to replace it?").format(e),a=l({type:"modal",content:n}),a.on("action:yes",function(e){r(),e.close()}),a.open()):r())},r.prototype.deleteAction=function(e){var t=e,o=this;runOrSignIn(function(){var e=$.t(" Do you really want to delete Drawing Template '{0}' ?").format(t),r=l({type:"modal",content:e});r.on("action:yes",function(e){o.removeTemplate.call(o,t),e.close()}),r.open()},{source:"Delete line tool template"})},r.prototype.showSaveDialog=function(e){var t="text",o=new i({fields:[new s({name:t,label:$.t("Template name")+":",maxLength:64,error:$.t("Please enter template name")})],title:$.t("Save Drawing Template As")});runOrSignIn(function(){o.show().then(function(o){e(o[t])})},{source:"Save line tool template",sourceMeta:"Chart"})},e.exports=r}).call(t,o(5))},3540:function(e,t,o){"use strict";function r(e,t){var o={};return o.background=t.paneProperties.background.value(),o.paneProperties={},o.paneProperties.crossHairProperties={},o.paneProperties.crossHairProperties.color=t.paneProperties.crossHairProperties.color.value(),o.paneProperties.crossHairProperties.style=t.paneProperties.crossHairProperties.style.value(),o.paneProperties.crossHairProperties.transparency=t.paneProperties.crossHairProperties.transparency.value(),o.paneProperties.crossHairProperties.width=t.paneProperties.crossHairProperties.width.value(),o.paneProperties.gridProperties={},o.paneProperties.gridProperties.color=t.paneProperties.gridProperties.color.value(),o.paneProperties.gridProperties.style=t.paneProperties.gridProperties.style.value(),o.paneProperties.horzGridProperties={},o.paneProperties.horzGridProperties.color=t.paneProperties.horzGridProperties.color.value(),o.paneProperties.horzGridProperties.style=t.paneProperties.horzGridProperties.style.value(),o.paneProperties.vertGridProperties={},o.paneProperties.vertGridProperties.color=t.paneProperties.vertGridProperties.color.value(),o.paneProperties.vertGridProperties.style=t.paneProperties.vertGridProperties.style.value(),o.symbolWatermarkProperties={},o.symbolWatermarkProperties.color=t.symbolWatermarkProperties.color.value(),o.symbolWatermarkProperties.transparency=t.symbolWatermarkProperties.transparency.value(),o.scalesProperties={},o.scalesProperties.fontSize=t.scalesProperties.fontSize.value(),o.scalesProperties.backgroundColor=t.scalesProperties.backgroundColor.value(),o.scalesProperties.lineColor=t.scalesProperties.lineColor.value(),o.scalesProperties.textColor=t.scalesProperties.textColor.value(),o.mainSeriesProperties={},o.mainSeriesProperties.style=e.style.value(),o.mainSeriesProperties.candleStyle={},o.mainSeriesProperties.candleStyle.borderColor=e.candleStyle.borderColor.value(),o.mainSeriesProperties.candleStyle.borderDownColor=e.candleStyle.borderDownColor.value(),o.mainSeriesProperties.candleStyle.borderUpColor=e.candleStyle.borderUpColor.value(),o.mainSeriesProperties.candleStyle.wickColor=e.candleStyle.wickColor.value(),
o.mainSeriesProperties.candleStyle.wickDownColor=e.candleStyle.wickDownColor.value(),o.mainSeriesProperties.candleStyle.wickUpColor=e.candleStyle.wickUpColor.value(),o.mainSeriesProperties.candleStyle.downColor=e.candleStyle.downColor.value(),o.mainSeriesProperties.candleStyle.upColor=e.candleStyle.upColor.value(),o.mainSeriesProperties.candleStyle.drawBorder=e.candleStyle.drawBorder.value(),o.mainSeriesProperties.candleStyle.drawWick=e.candleStyle.drawWick.value(),o}function n(e){var t={};return t.background=e.paneProperties.background,t.paneProperties={},t.paneProperties.crossHairProperties={},t.paneProperties.crossHairProperties.color=e.paneProperties.crossHairProperties.color,t.paneProperties.crossHairProperties.style=e.paneProperties.crossHairProperties.style,t.paneProperties.crossHairProperties.transparency=e.paneProperties.crossHairProperties.transparency,t.paneProperties.crossHairProperties.width=e.paneProperties.crossHairProperties.width,t.paneProperties.gridProperties={},t.paneProperties.gridProperties.color=e.paneProperties.gridProperties.color,t.paneProperties.gridProperties.style=e.paneProperties.gridProperties.style,t.paneProperties.horzGridProperties={},t.paneProperties.horzGridProperties.color=e.paneProperties.horzGridProperties.color,t.paneProperties.horzGridProperties.style=e.paneProperties.horzGridProperties.style,t.paneProperties.vertGridProperties={},t.paneProperties.vertGridProperties.color=e.paneProperties.vertGridProperties.color,t.paneProperties.vertGridProperties.style=e.paneProperties.vertGridProperties.style,t.symbolWatermarkProperties={},t.symbolWatermarkProperties.color=e.symbolWatermarkProperties.color,t.symbolWatermarkProperties.transparency=e.symbolWatermarkProperties.transparency,t.scalesProperties={},t.scalesProperties.fontSize=e.scalesProperties.fontSize,t.scalesProperties.backgroundColor=e.scalesProperties.backgroundColor,t.scalesProperties.lineColor=e.scalesProperties.lineColor,t.scalesProperties.textColor=e.scalesProperties.textColor,t.mainSeriesProperties={},t.mainSeriesProperties.style=e.mainSeriesProperties.style,t.mainSeriesProperties.candleStyle={},t.mainSeriesProperties.candleStyle.borderColor=e.mainSeriesProperties.candleStyle.borderColor,t.mainSeriesProperties.candleStyle.borderDownColor=e.mainSeriesProperties.candleStyle.borderDownColor,t.mainSeriesProperties.candleStyle.borderUpColor=e.mainSeriesProperties.candleStyle.borderUpColor,t.mainSeriesProperties.candleStyle.wickColor=e.mainSeriesProperties.candleStyle.wickColor,t.mainSeriesProperties.candleStyle.wickDownColor=e.mainSeriesProperties.candleStyle.wickDownColor,t.mainSeriesProperties.candleStyle.wickUpColor=e.mainSeriesProperties.candleStyle.wickUpColor,t.mainSeriesProperties.candleStyle.downColor=e.mainSeriesProperties.candleStyle.downColor,t.mainSeriesProperties.candleStyle.upColor=e.mainSeriesProperties.candleStyle.upColor,t.mainSeriesProperties.candleStyle.drawBorder=e.mainSeriesProperties.candleStyle.drawBorder,t.mainSeriesProperties.candleStyle.drawWick=e.mainSeriesProperties.candleStyle.drawWick,t}
function a(e,t){var o;for(o in e){if(e.hasOwnProperty(o)!==t.hasOwnProperty(o))return!1;switch(typeof e[o]){case"object":if(!a(e[o],t[o]))return!1;break;case"function":if(void 0===t[o]||"compare"!==o&&""+e[o]!=""+t[o])return!1;break;default:if(e[o]!==t[o])return!1}}for(o in t)if(void 0===e[o])return!1;return!0}function i(e,t,o){var i,u,d,h,f,m=document.createElement("div");return m.classList.add("tv-theme-switcher","i-float_left"),i=n(TradingView.defaultProperties.chartproperties),u={},p.fetch("/standard-theme/?themeName="+encodeURIComponent("Dark"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"same-origin"}).then(function(e){return e.json()}).then(function(e){u=JSON.parse(e.content),u={paneProperties:u.chartProperties.paneProperties,scalesProperties:u.chartProperties.scalesProperties,mainSeriesProperties:u.mainSourceProperties},u.paneProperties.crossHairProperties=i.paneProperties.crossHairProperties,u.paneProperties.gridProperties.style=i.paneProperties.gridProperties.style,u.scalesProperties.fontSize=i.scalesProperties.fontSize,u.symbolWatermarkProperties=i.symbolWatermarkProperties,u.paneProperties.horzGridProperties=u.paneProperties.gridProperties,u.paneProperties.vertGridProperties=u.paneProperties.gridProperties,u=n(u)}),d=document.createElement("span"),d.classList.add("tv-theme-switcher__title"),d.innerHTML=window.t("Theme",{context:"colorTheme"}),m.appendChild(d),h=[],Object.keys(s.themes).forEach(function(e){var t,o,r,n,a=s.themes[e];s.isPublicTheme(a)&&(t="tv-theme-switcher__"+a.name,o=document.createElement("a"),o.classList.add("js-switch-theme",t),o.setAttribute("data-theme",a.name),r=document.createElement("span"),r.classList.add(t+"-color"),n=document.createElement("span"),n.innerHTML=a.label,o.appendChild(r),o.appendChild(n),m.appendChild(o),h.push(o))}),f=function(e){var t,o,r="tv-theme-switcher__active",n=document.getElementsByClassName(r)[0];n?(n.classList.remove(r),t="tv-theme-switcher__"+e+"-color",o=document.getElementsByClassName(t)[0],o.classList.add(r)):(n=m.getElementsByClassName("tv-theme-switcher__"+s.watchedTheme.value()+"-color")[0],n.classList.add(r))},h.forEach(function(n){n.addEventListener("click",function(){var p,d,h=n.getAttribute("data-theme"),f=r(t,o);null!==h&&void 0!==h&&(a(f,i)||a(f,u)?e.loadTheme(h[0].toUpperCase()+h.substring(1),!0):(p=window.t("The user interface will change to the {0} theme. Do you want to switch the chart template as well?").format(h[0].toUpperCase()+h.substring(1)),p=TradingView.clean(p),d=c.createConfirmDialog({type:"modal",content:p}),d.on("action:yes",function(t){e.loadTheme(h[0].toUpperCase()+h.substring(1),!0),t.close()}),d.on("action:no",function(e){s.setTheme(h),e.close()}),l.trackEvent("GUI","Themes","Switch to "+h+" theme"),d.open()))})}),f(s.getCurrentTheme().name),s.watchedTheme.subscribe(f.bind(null)),{domNode:m,applyTheme:s.syncTheme,restore:function(){s.restoreTheme(),s.syncTheme()},restoreDefault:function(){s.setTheme(s.DEFAULT_THEME),s.syncTheme(),f(s.DEFAULT_THEME)}}}var s,l,c,p
;Object.defineProperty(t,"__esModule",{value:!0}),o(3541),o(1),s=o(479),l=o(15),c=o(517),p=o(25),o(14),t.createThemeSwitcher=i},3541:function(e,t){},478:function(e,t,o){"use strict";function r(e){var t=e.className,o=e.icon,r=void 0===o?"":o,a=e.onClick,i=e.title;return n.createElement("span",{title:i,className:t,dangerouslySetInnerHTML:{__html:r},onClick:a})}Object.defineProperty(t,"__esModule",{value:!0});var n=o(9);t.Icon=r},479:function(e,t,o){"use strict";function r(e,t){var o=b.colorsPalette[e];if(!o)throw Error("No such color "+e);return o}function n(e,o){var r,n;o||(o=window),r=o.document.documentElement;for(n in t.themes)t.themes[n].className&&r.classList.toggle(t.themes[n].className,n===e)}function a(e){return!e.isPrivate}function i(){return t.themes[t.watchedTheme.value()]||t.themes[t.DEFAULT_THEME]}function s(e){return i().getThemedColor(e)}function l(e){(window.TradingView.onChartPage||h.enabled("widget"))&&t.watchedTheme.setValue(e)}function c(){l(d.getValue(g)||t.DEFAULT_THEME)}function p(){d.setValue(g,i().name,{forceFlush:!0})}var u,d,h,f,m,b,g;Object.defineProperty(t,"__esModule",{value:!0}),o(36),o(1),u=o(8),d=o(30),h=o(5),f=o(2090),m=o(2091),b=o(1247),t.themes={light:{name:"light",label:window.t("Light",{context:"colorThemeName"}),className:"theme-light",order:2,getThemedColor:function(e){return r(e)}},dark:{name:"dark",label:window.t("Dark",{context:"colorThemeName"}),className:"theme-dark",order:1,getThemedColor:function(e){return r(f[e])}},sa:{isPrivate:!0,noChartTheme:!0,name:"sa",className:"theme-sa",getThemedColor:function(e){return r(m[e])}}},t.DEFAULT_THEME="light",t.watchedTheme=new u,t.watchedTheme.subscribe(function(e){n(e,window)}),t.applyTheme=n,t.isPublicTheme=a,t.getCurrentTheme=i,t.setThemedColor=s,t.setTheme=l,g="current_theme.name",t.restoreTheme=c,t.syncTheme=p},507:function(e,t,o){"use strict";var r,n,a,i;Object.defineProperty(t,"__esModule",{value:!0}),r=o(2),n=o(9),a=o(110),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleOutsideEvent=function(e){t.props.handler&&!a.findDOMNode(t).contains(e.target)&&t.props.handler(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.click&&document.addEventListener("click",this._handleOutsideEvent,!1),this.props.mouseDown&&document.addEventListener("mousedown",this._handleOutsideEvent,!1),this.props.touchEnd&&document.addEventListener("touchend",this._handleOutsideEvent,!1),this.props.touchStart&&document.addEventListener("touchstart",this._handleOutsideEvent,!1)},t.prototype.componentWillUnmount=function(){this.props.click&&document.removeEventListener("click",this._handleOutsideEvent,!1),this.props.mouseDown&&document.removeEventListener("mousedown",this._handleOutsideEvent,!1),this.props.touchEnd&&document.removeEventListener("touchend",this._handleOutsideEvent,!1),this.props.touchStart&&document.removeEventListener("touchstart",this._handleOutsideEvent,!1)},t.prototype.render=function(){var e=this.props,t=(e.click,e.handler,e.mouseDown,e.touchEnd,e.touchStart,
e.ctor),o=void 0===t?"span":t,a=r.__rest(e,["click","handler","mouseDown","touchEnd","touchStart","ctor"]);return n.createElement(o,r.__assign({},a))},t}(n.Component),t.OutsideEvent=i},584:function(e,t,o){"use strict";function r(e){var t,o=e.className,r=e.icon,u=e.clearable,d=e.onClear,h=e.size,f=e.strictLeftDirectionInput,m=n.__rest(e,["className","icon","clearable","onClear","size","strictLeftDirectionInput"]),b=i(c.inputWrapper,(t={},t[o]=!!o,t[c.iconed]=!!r,t[c.clearable]=u,t));return a.createElement(p,n.__assign({theme:c,className:b,leftComponent:r?a.createElement(s.Icon,{key:"inputIcon",icon:r,className:c.inputIcon}):void 0,rightComponent:u?a.createElement(s.Icon,{className:c.clearIcon,icon:l,key:"clearIcon",onClick:d}):void 0,sizeMode:h,strictLeftDirectionInput:f},m))}var n,a,i,s,l,c,p;Object.defineProperty(t,"__esModule",{value:!0}),n=o(2),a=o(9),i=o(28),s=o(478),l=o(134),c=o(597),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e,t,o,r,s=this.props,l=s.theme,p=s.error,u=s.success,d=s.sizeMode,h=s.leftComponent,f=s.rightComponent,m=s.grouped,b=s.fontSize,g=s.reference,y=s.className,v=(s.strictLeftDirectionInput,n.__rest(s,["theme","error","success","sizeMode","leftComponent","rightComponent","grouped","fontSize","reference","className","strictLeftDirectionInput"])),_={fontSize:b},w=i(l.textInput,this.props.strictLeftDirectionInput&&c.textInputLeftDirection,(o={},o[l.error]=p,o[l.success]=u,o[l[d]]=!!d,o)),P=i(l.inputWrapper,(r={},r[y]=!!y,r[l.grouped]=m,r)),T=[],C=a.createElement("input",n.__assign({ref:g,className:w,key:"textInput",style:_},v));return h&&(e={className:i(l.leftComponent,h.props.className),key:"leftComponent"},T.push(a.cloneElement(h,e))),T.push(C),f&&(t={className:i(l.rightComponent,f.props.className),key:"rightComponent"},T.push(a.cloneElement(f,t))),a.createElement("div",{className:P},T)},t}(a.PureComponent),t.CommonTextInput=p,t.TextInput=r},597:function(e,t){e.exports={inputWrapper:"inputWrapper-6bNZbTW4-",textInput:"textInput-3WRWEmm7-",error:"error-v0663AtN-",success:"success-7iP8kTY5-",textInputLeftDirection:"textInputLeftDirection-mlAXPh8V-",xsmall:"xsmall-3Ah_Or2--",small:"small-2bmxiJCE-",large:"large-1JDowW2I-",iconed:"iconed-3ZQvxTot-",inputIcon:"inputIcon-W_Bse-a1-",clearable:"clearable-2tabt_rj-",clearIcon:"clearIcon-389FR5J4-",grouped:"grouped-34HX1lDr-"}},614:function(e,t,o){"use strict";function r(e){return function(t){function o(e){var o=t.call(this,e)||this;return o._keyboardListener=new i,o._listener=o._keyboardListener.listen.bind(o._keyboardListener),o}return n.__extends(o,t),o.prototype.componentDidMount=function(){this._registerHandlers(this.props.keyboardEventHandlers)},o.prototype.componentWillReceiveProps=function(e){this.props.keyboardEventHandlers!==e.keyboardEventHandlers&&this._registerHandlers(e.keyboardEventHandlers)},o.prototype.render=function(){return a.createElement(e,n.__assign({},this.props,{onKeyDown:this._listener}))},o.prototype._registerHandlers=function(e){
e&&(this._keyboardListener.deleteAllHandlers(),this._keyboardListener.registerHandlers(e))},o}(a.PureComponent)}var n,a,i;Object.defineProperty(t,"__esModule",{value:!0}),n=o(2),a=o(9),function(e){e[e.Enter=13]="Enter",e[e.Space=32]="Space",e[e.Backspace=8]="Backspace",e[e.DownArrow=40]="DownArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.LeftArrow=37]="LeftArrow",e[e.Escape=27]="Escape",e[e.Tab=9]="Tab"}(t.KeyCode||(t.KeyCode={})),i=function(){function e(){this._handlers=new Map}return e.prototype.registerHandlers=function(e){var t=this;Object.keys(e).forEach(function(o){var r,n=parseInt(o),a=e[n];Array.isArray(a)||(a=[a]),t._handlers.has(n)?(r=t._handlers.get(n))&&a.forEach(function(e){return r.add(e)}):t._handlers.set(n,new Set(a))})},e.prototype.unregisterHandlers=function(e){var t=this;Object.keys(e).forEach(function(o){var r,n=parseInt(o),a=e[n];Array.isArray(a)||(a=[a]),t._handlers.has(n)&&(r=t._handlers.get(n))&&a.forEach(function(e){return r.delete(e)})})},e.prototype.deleteAllHandlers=function(){this._handlers=new Map},e.prototype.registerHandler=function(e,t){if(this._handlers.has(e)){var o=this._handlers.get(e);o&&o.add(t)}else this._handlers.set(e,new Set([t]))},e.prototype.unregisterHandler=function(e,t){if(this._handlers.has(e)){var o=this._handlers.get(e);o&&o.delete(t)}},e.prototype.listen=function(e){if(this._handlers.has(e.keyCode)){var t=this._handlers.get(e.keyCode);t&&t.forEach(function(t){return t(e)})}},e}(),t.KeyboardListener=i,t.makeKeyboardListener=r},615:function(e,t,o){"use strict";function r(e){var t,o=e.dropped,r=void 0!==o&&o,s=e.small,l=void 0!==s&&s,c=e.colorTransition,p=void 0!==c&&c,u=e.style,d=void 0===u?{}:u,h=e.className,f=void 0===h?"":h,m=i(f,a.caret,(t={},t[a.caretRotate]=r,t[a.caretSmall]=l,t[a.caretColorTransition]=p,t));return n.createElement("i",{className:m,style:d})}var n,a,i;Object.defineProperty(t,"__esModule",{value:!0}),n=o(9),a=o(684),i=o(28),t.Caret=r},684:function(e,t){e.exports={caret:"caret-3_GTxtct-",caretRotate:"caretRotate-98O6Gi4f-",caretSmall:"caretSmall-1vg6w8eZ-",caretColorTransition:"caretColorTransition-1y-c2tgp-"}},781:function(e,t,o){"use strict";function r(e,t){return""===e||-1!==t.toLowerCase().indexOf(e.toLowerCase())}var n,a,i,s,l,c,p,u,d,h,f;Object.defineProperty(t,"__esModule",{value:!0}),n=o(2),o(1),a=o(9),i=o(615),s=o(584),l=o(507),c=o(614),p=o(28),u=o(784),d=o(597),h=function(e){return Array.isArray(e.source)||!e.allowUserDefinedValues},f=function(e){function t(t){var o=e.call(this,t)||this;if(o._setInputRef=function(e){e&&(o._inputElement=e,o.props.setupHTMLInput&&o.props.setupHTMLInput(e),o._inputElement.addEventListener("keyup",o._handleKeyUpEnter))},o._handleCaretClick=function(){o.state.isOpened?o._close():o.props.preventOnFocusOpen?o._open():o._focus()},o._handleOutsideClick=function(){var e=o.props,t=e.allowUserDefinedValues,r=e.value,n=e.onChange,a=o.state.queryValue;t&&a!==r?n&&n(a):o.setState(o._valueToQuery(r)),o._close()},o._handleFocus=function(e){o.props.preventOnFocusOpen||o._open(),
o.props.onFocus&&o.props.onFocus(e)},o._handleChange=function(e){var t,r=e.currentTarget.value;o.props.preventSearchOnEmptyQuery&&""===r?o.setState({queryValue:r,isOpened:!1,active:void 0}):(t=o._suggestions(r),o.setState({queryValue:r,isOpened:Object.keys(t).length>0,active:o.props.allowUserDefinedValues?void 0:o._getActiveKeyByValue(r)}))},o._handleItemClick=function(e){var t=e.currentTarget.id;o.setState({queryValue:o._source()[t]}),o._close(),o.props.onChange&&o.props.onChange(t)},o._handleKeyDown=function(e){var t,r,n,a,i,s,l,p,u,d,h,f,m,b;if(-1!==[c.KeyCode.DownArrow,c.KeyCode.UpArrow,c.KeyCode.Enter,c.KeyCode.Escape].indexOf(e.which))switch(e.preventDefault(),e.stopPropagation(),t=o.props,r=t.allowUserDefinedValues,n=t.value,a=t.onChange,i=o.state,s=i.active,l=i.isOpened,p=i.queryValue,u=o._suggestions(p),e.which){case c.KeyCode.DownArrow:case c.KeyCode.UpArrow:if(d=Object.keys(u),!l&&d.length&&e.which===c.KeyCode.DownArrow){o.setState({isOpened:!0,active:d[0]});break}if(h=void 0,void 0===s){if(e.which===c.KeyCode.UpArrow){o._close();break}h=0}else h=d.indexOf(s)+(e.which===c.KeyCode.UpArrow?-1:1);h<0&&(h=0),h>d.length-1&&(h=d.length-1),f=d[h],o.setState({active:f}),(m=document.getElementById(f))&&o._scrollIfNotVisible(m,o._suggestionsElement);break;case c.KeyCode.Escape:o._close(),l||o._blur();break;case c.KeyCode.Enter:b=s,r&&(l&&b?o.setState(o._valueToQuery(b)):b=p),void 0!==b&&(o._close(),l||o._blur(),b!==n?a&&a(b):o.setState(o._valueToQuery(b)))}},o._setSuggestionsRef=function(e){e&&(o._suggestionsElement=e)},o._scrollIfNotVisible=function(e,t){var o=t.scrollTop,r=t.scrollTop+t.clientHeight,n=e.offsetTop,a=e.clientHeight,i=n+a;return n<=o?void e.scrollIntoView(!0):i>=r?void e.scrollIntoView(!1):void 0},!h(t))throw Error("allowUserDefinedProps === true cay only be used if source is array");return o.state=n.__assign({isOpened:!1,active:t.value},o._valueToQuery(t.value)),o}return n.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){this.setState({queryValue:""===e.value?"":this._source()[e.value]||this.state.queryValue,active:e.value})},t.prototype.componentWillUnmount=function(){this._inputElement&&this._inputElement.removeEventListener("keyup",this._handleKeyUpEnter)},t.prototype.render=function(){return a.createElement(l.OutsideEvent,{ctor:"div",className:p(u.autocomplete,(e={},e[u.opened]=this.state.isOpened,e),"js-dialog-skip-escape"),handler:this._handleOutsideClick,click:!0},a.createElement(s.CommonTextInput,{rightComponent:Object.keys(this._suggestions(this.state.queryValue)).length?a.createElement("div",{className:u.caret,onClick:this._handleCaretClick},a.createElement(i.Caret,{className:u.icon,dropped:this.state.isOpened})):void 0,theme:d,reference:this._setInputRef,className:u.textInput,placeholder:this.props.placeholder,value:this.state.queryValue,error:this.props.error,onChange:this._handleChange,onFocus:this._handleFocus,onBlur:this.props.onBlur,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut,onKeyDown:this._handleKeyDown}),this._renderSuggestions());var e},
t.prototype._focus=function(){this._inputElement.focus()},t.prototype._blur=function(){this._inputElement.blur()},t.prototype._open=function(){this.setState({isOpened:!0})},t.prototype._close=function(){this.setState({isOpened:!1,active:void 0})},t.prototype._source=function(){var e={};return Array.isArray(this.props.source)?this.props.source.forEach(function(t){e[t]=t}):e=this.props.source,e},t.prototype._suggestions=function(e){var t=this.props,o=t.value,n=t.filter,a=void 0===n?r:n,i=this._source(),s={},l=Object.keys(i);return e!==i[o]&&(l=l.filter(function(t){return a(e,i[t])})),l.forEach(function(e){return s[e]=i[e]}),s},t.prototype._renderSuggestions=function(){var e=this,t=this._suggestions(this.state.queryValue),o=Object.keys(t).map(function(o){var r,n=p(u.suggestion,(r={},r[u.selected]=e.state.active===o,r));return a.createElement("li",{id:o,key:o,className:n,onClick:e._handleItemClick},t[o])}),r=a.createElement("li",{className:u.noResults},window.t("No results found"));return!o.length&&this.props.noEmptyText?null:a.createElement("ul",{className:u.suggestions,ref:this._setSuggestionsRef},o.length?o:r)},t.prototype._handleKeyUpEnter=function(e){e.which===c.KeyCode.Enter&&e.stopImmediatePropagation()},t.prototype._getActiveKeyByValue=function(e){var t,o,n,a=this.props.filter,i=void 0===a?r:a,s=this._suggestions(e),l=Object.keys(s);for(t=0,o=l;t<o.length;t++)if(n=o[t],i(e,s[n]))return n;return l[0]},t.prototype._valueToQuery=function(e){return{queryValue:this._source()[e]||""}},t}(a.PureComponent),t.Autocomplete=f},784:function(e,t){e.exports={autocomplete:"autocomplete-S6SpJGmW-",caret:"caret-3fqF_ykE-",icon:"icon-1POgzoN_-",textInput:"textInput-1mZnCCcA-",suggestions:"suggestions-NOVMFmSY-",suggestion:"suggestion-3xakscNf-",noResults:"noResults-1pgHgvGL-",selected:"selected-3wOAQHl8-",opened:"opened-2C-bn3cP-"}},991:function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n;Object.defineProperty(t,"__esModule",{value:!0}),n=function(){function e(e,t){var o,r;for(o=0;o<t.length;o++)r=t[o],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),t.InputField=function(){function e(t){var o=t.label,n=t.name,a=t.maxLength,i=t.error,s=void 0===i?"":i;r(this,e),this._name=n,this._$field=$('<label class="tv-rename-chart-dialog__field">\n\t\t\t\t<span class="tv-rename-chart-dialog__label">'+o+'</span>\n\t\t\t\t<input class="tv-control-input" type="text" name="'+n+'" maxlength="'+a+'"/>\n\t\t\t</label>'),this._$input=this._$field.find("input"),this._error=s}return n(e,[{key:"appendTo",value:function(e){e.append(this._$field)}},{key:"focus",value:function(){return this._$input.focus()}},{key:"select",value:function(){return this.focus().select()}},{key:"value",set:function(e){this._$input.val(e)},get:function(){return this._$input.val()}},{key:"name",get:function(){return this._name}},{key:"valid",get:function(){
return!!this._$input.val().trim()}},{key:"error",set:function(e){this._error=e},get:function(){return this._error}}]),e}()},992:function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.SaveRenameDialog=void 0,n=function(){function e(e,t){var o,r;for(o=0;o<t.length;o++)r=t[o],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),o(1008),a=o(19),t.SaveRenameDialog=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.fields,n=t.title,a=void 0===n?"":n,i=t.destroyOnClose,s=void 0===i||i,l=t.modal,c=void 0!==l&&l;r(this,e),this._$form=$("<div></div>"),this._fields=o,this._appendFieldsToForm(),this._title=a,this._destroyOnClose=s,this._modal=c}return n(e,[{key:"setField",value:function(e,t){this._fields.find(function(t){return t.name===e}).value=t}},{key:"show",value:function(){var e=this,t=this._createDialog(),o=new Promise(function(o){t.on("action:submit",function(t){return e._onSubmit(t,o)})});return t.open(),t.on("beforeClose",this._unmountFields.bind(this)),this._fields[0].select(),o}},{key:"_appendFieldsToForm",value:function(){var e=this;this._fields.forEach(function(t){t.appendTo(e._$form)})}},{key:"_createDialog",value:function(){return(0,a.createDialog)({type:this._modal?"modal":"popup",title:this._title,content:this._$form,actionsWrapTemplate:'<div class="tv-dialog__section tv-dialog__section--actions i-align_right tv-dialog__section--no-border">',width:470,destroyOnClose:this._destroyOnClose,actions:[{name:"submit",type:"primary",text:$.t("Save"),key:13,addClass:"js-submit-button"},{name:"cancel",type:"default",text:$.t("Cancel"),method:"close",addClass:"js-cancel-button"}]})}},{key:"_onSubmit",value:function(e,t){var o=this._validate();o?(e.error(o.error),o.focus()):(t(this._collectValues(),e),e.close())}},{key:"_validate",value:function(){return this._fields.find(function(e){return!e.valid})}},{key:"_collectValues",value:function(){return this._fields.reduce(function(e,t){return e[t.name]=t.value,e},{})}},{key:"_unmountFields",value:function(){this._fields.forEach(function(e){e.unmount&&e.unmount()})}}]),e}()}});